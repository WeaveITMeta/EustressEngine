// ============================================================================
// Eustress Engine Studio - Toolbox Panel
// Part insertion tools and primitives
// ============================================================================

import { VerticalBox, HorizontalBox, ScrollView, GridBox } from "std-widgets.slint";
import { Theme, PanelHeader, IconButton } from "theme.slint";

// Tool category
export struct ToolCategory {
    name: string,
    icon: string,
    expanded: bool,
}

// Tool item
export struct ToolItem {
    id: string,
    name: string,
    icon: string,
    tooltip: string,
    category: string,
}

component ToolButton inherits Rectangle {
    in property <string> icon: "";
    in property <string> label: "";
    in property <string> tooltip: "";
    in property <bool> selected: false;
    
    callback clicked();
    
    width: 64px;
    height: 64px;
    background: self.selected ? Theme.selection-background : 
                touch.has-hover ? Theme.explorer-item-hover : transparent;
    border-radius: 4px;
    
    touch := TouchArea {
        clicked => { root.clicked(); }
    }
    
    VerticalBox {
        padding: 4px;
        spacing: 2px;
        alignment: center;
        
        Text {
            text: root.icon;
            color: root.selected ? Theme.accent-blue : Theme.text-primary;
            font-size: 24px;
            horizontal-alignment: center;
        }
        
        Text {
            text: root.label;
            color: Theme.text-secondary;
            font-size: 10px;
            horizontal-alignment: center;
            overflow: elide;
        }
    }
}

export component Toolbox inherits Rectangle {
    // Properties
    in property <string> current-tool: "select";
    in property <[ToolItem]> tools: [];
    
    // Callbacks
    callback on-select-tool(string);
    callback on-insert-part(string);
    
    background: Theme.panel-background;
    
    ScrollView {
        VerticalBox {
            padding: 8px;
            spacing: 8px;
            
            // Transform Tools
            PanelHeader {
                title: "Transform";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "ðŸ–±";
                    label: "Select";
                    selected: root.current-tool == "select";
                    clicked => { root.on-select-tool("select"); }
                }
                
                ToolButton {
                    icon: "â†”";
                    label: "Move";
                    selected: root.current-tool == "move";
                    clicked => { root.on-select-tool("move"); }
                }
                
                ToolButton {
                    icon: "ðŸ”„";
                    label: "Rotate";
                    selected: root.current-tool == "rotate";
                    clicked => { root.on-select-tool("rotate"); }
                }
                
                ToolButton {
                    icon: "â¤¢";
                    label: "Scale";
                    selected: root.current-tool == "scale";
                    clicked => { root.on-select-tool("scale"); }
                }
            }
            
            // Primitives
            PanelHeader {
                title: "Primitives";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "â–¢";
                    label: "Block";
                    clicked => { root.on-insert-part("Part"); }
                }
                
                ToolButton {
                    icon: "â—¯";
                    label: "Sphere";
                    clicked => { root.on-insert-part("SpherePart"); }
                }
                
                ToolButton {
                    icon: "â–³";
                    label: "Wedge";
                    clicked => { root.on-insert-part("WedgePart"); }
                }
                
                ToolButton {
                    icon: "â¬¡";
                    label: "Cylinder";
                    clicked => { root.on-insert-part("CylinderPart"); }
                }
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "âŠ•";
                    label: "Corner";
                    clicked => { root.on-insert-part("CornerWedgePart"); }
                }
                
                ToolButton {
                    icon: "ðŸ”²";
                    label: "Truss";
                    clicked => { root.on-insert-part("TrussPart"); }
                }
            }
            
            // Models
            PanelHeader {
                title: "Models";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "ðŸ“¦";
                    label: "Model";
                    clicked => { root.on-insert-part("Model"); }
                }
                
                ToolButton {
                    icon: "ðŸ“";
                    label: "Folder";
                    clicked => { root.on-insert-part("Folder"); }
                }
            }
            
            // Lighting
            PanelHeader {
                title: "Lighting";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "ðŸ’¡";
                    label: "Point";
                    clicked => { root.on-insert-part("PointLight"); }
                }
                
                ToolButton {
                    icon: "ðŸ”¦";
                    label: "Spot";
                    clicked => { root.on-insert-part("SpotLight"); }
                }
                
                ToolButton {
                    icon: "â˜€";
                    label: "Surface";
                    clicked => { root.on-insert-part("SurfaceLight"); }
                }
            }
            
            // Physics
            PanelHeader {
                title: "Physics";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "âš“";
                    label: "Anchor";
                    clicked => { root.on-insert-part("Attachment"); }
                }
                
                ToolButton {
                    icon: "ðŸ”—";
                    label: "Weld";
                    clicked => { root.on-insert-part("WeldConstraint"); }
                }
                
                ToolButton {
                    icon: "ðŸ”©";
                    label: "Hinge";
                    clicked => { root.on-insert-part("HingeConstraint"); }
                }
            }
            
            // Scripts
            PanelHeader {
                title: "Scripts";
                collapsible: true;
            }
            
            HorizontalBox {
                spacing: 4px;
                
                ToolButton {
                    icon: "@";
                    label: "Soul";
                    clicked => { root.on-insert-part("SoulScript"); }
                }
                
                ToolButton {
                    icon: "ðŸ“œ";
                    label: "Local";
                    clicked => { root.on-insert-part("LocalScript"); }
                }
                
                ToolButton {
                    icon: "ðŸ“‹";
                    label: "Module";
                    clicked => { root.on-insert-part("ModuleScript"); }
                }
            }
        }
    }
}
